<div class="p-3 content" th:fragment="perhitungan-saw">
    <div th:replace="~{components/content-title::title(bi-trophy,
        ${@textConstant.dataPerhitunganSAW}, ${pengguna.role.name() == 'ADMIN'
        ? @textConstant.deskripsiPerhitunganSAWAdmin : @textConstant.deskripsiPerhitunganSAWAnakBuah})}"></div>




    <div class="card border-black my-4">

        <!-- Tabs -->
        <ul class="nav nav-tabs" id="sawTab" role="tablist">
            <li class="nav-item" role="presentation" th:if="${pengguna.role.name() == 'ADMIN'}">
                <button class="nav-link active" id="masuk-tab" data-bs-toggle="tab" data-bs-target="#masuk"
                    type="button" role="tab" th:text="${@textConstant.transaksiMasuk}">
                </button>
            </li>
            <li class="nav-item" role="presentation" th:if="${pengguna.role.name() == 'ADMIN'}">
                <button class="nav-link" id="keluar-tab" data-bs-toggle="tab" data-bs-target="#keluar" type="button"
                    role="tab" th:text="${@textConstant.transaksiKeluar}">
                </button>
            </li>
        </ul>

        <div class="tab-content mt-3 mx-3" id="sawTabContent">
            <div class="tab-pane fade show active" id="masuk" role="tabpanel">
                <div th:with="sawData=${sawTransaksiMasukFull}">
                    <div th:insert="~{this ::sawBlock(${sawData})}"></div>
                </div>
            </div>

            <div class="tab-pane fade" id="keluar" role="tabpanel" th:if="${pengguna.role.name() == 'ADMIN'}">
                <div th:with="sawData=${sawTransaksiKeluarFull}">
                    <div th:insert="~{this ::sawBlock(${sawData})}"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- FRAGMENT: SAW Block -->
    <th:block th:fragment="sawBlock(sawData)">
        <th:block th:if="${sawData != null}">
            <!-- 1. Bobot Kriteria -->
            <div class="card mt-3 mb-4 shadow-sm border-secondary">
                <div class="card-header bg-success text-white fw-bold small">
                    Langkah 1: Bobot Tiap Kriteria (W)
                </div>
                <div class="card-body">
                    <p class="text-muted small">
                        Bobot adalah nilai yang menunjukkan tingkat kepentingan dari masing-masing kriteria dalam proses
                        pengambilan keputusan.
                        Penentuan bobot biasanya dilakukan berdasarkan survei, pengalaman, atau kebijakan pengambil
                        keputusan.
                        Nilai total bobot harus sama dengan 1 agar perhitungan proporsional.
                        Semakin tinggi bobot suatu kriteria, semakin besar pengaruhnya terhadap hasil akhir.
                    </p>
                    <table class="table table-sm table-bordered text-center">
                        <thead class="table-light">
                            <tr>
                                <th>Kode</th>
                                <th>Nama Kriteria</th>
                                <th>Bobot</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>C1</td>
                                <td>Harga</td>
                                <td>0.50</td>
                            </tr>
                            <tr>
                                <td>C2</td>
                                <td>Volume (Berat)</td>
                                <td>0.30</td>
                            </tr>
                            <tr>
                                <td>C3</td>
                                <td>Permintaan</td>
                                <td>0.20</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 2. Matriks Keputusan -->
            <div class="card mb-4 shadow-sm border-secondary">
                <div class="card-header bg-primary text-white fw-bold small">
                    Langkah 2: Matriks Keputusan (X)
                </div>
                <div class="card-body">
                    <p class="text-muted small">
                        Matriks keputusan berisi nilai awal (nilai asli) yang diperoleh setiap alternatif pada setiap
                        kriteria.
                        Nilai ini dapat berupa angka kuantitatif seperti harga, berat, atau nilai kualitas.
                        Matriks ini disusun dalam bentuk tabel di mana baris mewakili alternatif dan kolom mewakili
                        kriteria.
                    </p>
                    <table class="table table-sm table-bordered text-center">
                        <thead class="table-light">
                            <tr>
                                <th>Barang</th>
                                <th>C1 (Harga)</th>
                                <th>C2 (Volume/Berat)</th>
                                <th>C3 (Permintaan)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="entry : ${sawData.keputusan}">
                                <td th:text="${entry.key.namaBarang}">Barang</td>
                                <td th:text="${#numbers.formatDecimal(entry.value['harga'], 1, 2)}">0.00</td>
                                <td th:text="${#numbers.formatDecimal(entry.value['volume'], 1, 2)}">0.00</td>
                                <td th:text="${#numbers.formatDecimal(entry.value['permintaan'], 1, 2)}">0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 3. Matriks Normalisasi -->
            <div class="card mb-4 shadow-sm border-secondary">
                <div class="card-header bg-warning text-dark fw-bold small">
                    Langkah 3: Matriks Normalisasi (R)
                </div>
                <div class="card-body">
                    <p class="text-muted small">
                        Normalisasi bertujuan untuk menyamakan skala penilaian agar setiap kriteria berada pada rentang 0â€“1.
                        Nilai pada setiap kolom dibagi dengan nilai maksimum kolom tersebut untuk kriteria keuntungan (*benefit criteria*),
                        atau nilai minimum untuk kriteria biaya (*cost criteria*).
                    </p>
                    <table class="table table-sm table-bordered text-center">
                        <thead class="table-light">
                            <tr>
                                <th>Barang</th>
                                <th>C1 (Harga)</th>
                                <th>C2 (Volume/Berat)</th>
                                <th>C3 (Permintaan)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="entry : ${sawData.normalisasi}">
                                <td th:text="${entry.key.namaBarang}">Barang</td>
                                <td th:text="${#numbers.formatDecimal(entry.value['harga'], 1, 2)}">0.00</td>
                                <td th:text="${#numbers.formatDecimal(entry.value['volume'], 1, 2)}">0.00</td>
                                <td th:text="${#numbers.formatDecimal(entry.value['permintaan'], 1, 2)}">0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 4. Skor Akhir -->
            <div class="card mb-4 shadow-sm border-secondary">
                <div class="card-header bg-secondary text-white fw-bold small">
                    Langkah 4: Skor Akhir (R * W)
                </div>
                <div class="card-body">
                    <p class="text-muted small">
                        Setiap nilai normalisasi dikalikan dengan bobot kriteria, lalu dijumlahkan untuk mendapatkan skor akhir setiap alternatif.
                        Skor tertinggi menunjukkan alternatif terbaik sesuai kriteria yang digunakan.
                    </p>
                    <table class="table table-sm table-bordered text-center">
                        <thead class="table-light">
                            <tr>
                                <th>Barang</th>
                                <th>Skor Akhir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="s : ${sawData.skor}">
                                <td th:text="${s.barang}">Barang</td>
                                <td th:text="${#numbers.formatDecimal(s.skor, 1, 3)}">0.0000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </th:block>
    </th:block>
</div>